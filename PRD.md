# 产品需求文档 (PRD)：AI 智能开单对话模块

## 1. 产品概述
**产品名称**：兴盛批发部 AI 开单助手（对话模块）
**目标用户**：下游采购商、小店老板（如：李老板）、批发部老客户。
**核心定位**：一个基于大语言模型（LLM）的多模态智能对话系统，旨在替代传统的“翻找目录-加购物车-结算”的繁琐电商流程。用户可以通过最自然的语音、拍照或简短文字，像和真人业务员微信聊天一样完成查货、开单、售后等全链路操作。

## 2. 核心目标
*   **极简交互**：降低下沉市场用户（如年纪较大的店主）的使用门槛，实现“张嘴就开单”。
*   **提升转化**：通过智能推荐、缺货替代、常购清单等 AI 主动营销手段，提高客单价。
*   **闭环体验**：在对话流内完成从“意图识别 -> 订单草稿 -> 修改确认 -> 生成凭证”的完整交易闭环。

---

## 3. 功能需求详细说明

### 3.1 多模态输入系统 (Multimodal Input)
用户可以通过三种方式与 AI 助手交互：
*   **语音输入 (Voice)**：
    *   **入口**：底部输入框的麦克风图标。
    *   **交互**：点击后唤起全屏毛玻璃遮罩，展示动态声波纹理和“正在聆听”状态，模拟真实的语音引擎激活体验。
    *   **功能**：将用户的语音指令（如“来50箱可乐”）转化为文本并发送给 AI。
*   **视觉输入 (Camera/Vision)**：
    *   **入口**：底部输入框的相机图标。
    *   **交互**：唤起沉浸式全屏相机取景器，带有科技感的蓝色上下扫描线动画。
    *   **功能**：支持两种核心视觉场景：
        1.  **拍手写单**：识别用户手写的缺货清单（OCR + 语义理解）。
        2.  **扫二维码/条码**：直接扫描实体商品条码进行补货。
*   **文本输入 (Text)**：
    *   常规的底部输入框，支持键盘打字，回车或点击发送按钮提交。

### 3.2 新手引导与快捷建议 (Onboarding & Suggestions)
*   **欢迎语 (Welcome Message)**：新会话建立时，AI 自动发送带有亲切称呼（“李老板下午好”）的欢迎语。
*   **操作指引**：在欢迎语中明确告知用户支持的三种交互方式（语音、拍照、打字），并配有 Emoji 降低阅读疲劳。
*   **快捷建议气泡 (Suggestion Chips)**：
    *   在欢迎语下方和输入框上方，提供可横向滑动的快捷操作胶囊（如：本周爆款、限时特惠、常购清单）。
    *   **目的**：解决用户“不知道第一句话该说什么”的冷启动问题，实现一键体验核心功能。

### 3.3 智能意图识别与场景处理 (AI Intent Handling)
AI 需能精准识别并处理以下复杂的真实业务场景：
1.  **直接下单 (Direct Order)**：识别商品名称和数量，直接生成订单草稿（例：“我要50箱可乐和20盒薯片”）。
2.  **缺货推荐 (Out of Stock)**：当用户请求的商品无货（如“雪碧”）时，AI 需致歉并主动推荐同类替代品（如“可口可乐”、“七喜”），并提供一键替换按钮。
3.  **库存不足调整 (Low Inventory)**：当用户请求数量大于库存（如要10箱红牛，仅剩5箱）时，AI 自动将草稿数量调整为最大库存量，并高亮显示警告信息（Warning UI）。
4.  **模糊意图澄清 (Fuzzy Intent)**：当用户指令模糊（如“来点水”）时，AI 需追问具体品牌，并提供“随便来5箱最畅销的”等兜底选项。
5.  **主动营销 (Marketing)**：响应“本周爆款”、“限时特惠”、“常购清单”等指令，一键生成包含多件推荐商品的采购清单。
6.  **售后与物流 (After-sales & Tracking)**：
    *   响应“催单”、“发货了吗”：查询最新订单状态，并提供“帮我加急”的快捷操作。
    *   响应“退货”、“坏了”：安抚情绪，引导用户调用相机拍照上传破损凭证。

### 3.4 交互式订单草稿 (Interactive Order Draft)
当 AI 识别到下单意图时，在对话流中渲染结构化的订单草稿卡片（OrderDraftCard）：
*   **商品明细**：展示商品名称、单价、单位、数量。
*   **数量微调**：卡片内直接提供 `+` `-` 步进器，允许用户在确认前修改数量。
*   **商品替换**：提供“更换”按钮，点击唤起底部半屏弹窗（Bottom Sheet），展示 AI 推荐的替代商品列表供用户重新选择。
*   **总价计算**：实时计算并展示预估总额。
*   **确认动作**：底部提供醒目的“确认生成订单”按钮。

### 3.5 订单确认与分享凭证 (Confirmation & Sharing)
*   **状态锁定**：用户点击“确认生成订单”后，草稿卡片变为只读状态，隐藏修改按钮。
*   **系统确认**：AI 回复确认文本（如“订单已确认，智能调度系统已安排优先发货”）。
*   **生成订货单图片 (Order Image Card)**：
    *   在对话流中自动生成一张精美的、类似实体收据的卡片。
    *   包含：订单号、商品清单、合计总额、视觉防伪底纹。
    *   提供“转发给客户/老板”按钮，方便采购员向上级汇报或留存凭证。

### 3.6 会话管理 (Session Management)
*   **历史记录**：支持保存历史对话，用户可通过侧边栏（Drawer）查看过往的采购沟通记录。
*   **新建对话**：点击顶部“新对话”按钮，清空当前上下文，重新触发欢迎语和快捷建议。

---

## 4. 交互与 UI/UX 规范
*   **设计风格**：采用现代、干净的浅色主题（Light Mode），背景带有微弱的蓝色/紫色渐变光晕，体现 AI 科技感但不刺眼。
*   **动效设计**：
    *   消息气泡采用 `spring` 弹簧动画滑入。
    *   语音和相机遮罩采用平滑的淡入淡出（Fade in/out）和毛玻璃（Backdrop blur）效果。
    *   按钮点击需有缩放反馈（`active:scale-95`）。
*   **信息层级**：AI 消息使用白色气泡，用户消息使用品牌蓝色气泡。订单草稿和凭证卡片使用高对比度的边框和阴影以突出显示。

--- 
**版本记录**
*   v1.0: 基础对话与购物车联动。
*   v1.1: 引入多模态（语音/相机）UI 模拟。
*   v1.2: 完善缺货、库存不足等异常流处理。
*   v1.3: 增加新手引导、快捷建议及可转发的订单凭证卡片。
